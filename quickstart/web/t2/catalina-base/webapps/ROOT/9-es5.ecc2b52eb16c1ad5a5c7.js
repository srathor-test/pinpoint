function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"/n0m":function(t,e,n){"use strict";var i,a;n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.META=2]="META",t[t.TRANSACTION_ID=3]="TRANSACTION_ID",t[t.TYPE=4]="TYPE",t[t.GROUP_COUNT=5]="GROUP_COUNT"}(i||(i={})),function(t){t[t.AGENT_NAME=0]="AGENT_NAME",t[t.TRANSACTION_PREFIX_1=1]="TRANSACTION_PREFIX_1",t[t.TRANSACTION_PREFIX_2=2]="TRANSACTION_PREFIX_2"}(a||(a={}));var o=function(){function t(e,n){_classCallCheck(this,t),this.originalData=e,this.typeManager=n,this.agentList=[],this.transactionDataByAgent={},this.countByType={},this.initVariable(),this.initInnerDataStructure(),this.classifyDataByAgent()}return _createClass(t,[{key:"initVariable",value:function(){this.from=this.originalData.from,this.to=this.originalData.to,this.originalData.complete?(this.fromX=this.originalData.from,this.toX=this.originalData.to):(this.fromX=this.originalData.resultFrom,this.toX=this.originalData.resultTo),this.agentMetadata=this.originalData.scatter.metadata,this.transactionData=[]}},{key:"initInnerDataStructure",value:function(){var t=this;Object.keys(this.agentMetadata).forEach((function(e){var n=t.agentMetadata[e][a.AGENT_NAME];t.transactionDataByAgent[n]=[],t.countByType[n]={},t.typeManager.getTypeNameList().forEach((function(e){t.countByType[n][e]=0})),-1===t.agentList.indexOf(n)&&t.agentList.push(n)})),this.agentList.sort()}},{key:"classifyDataByAgent",value:function(){var t=this;this.originalData.scatter.dotList.forEach((function(e){var n=t.getAgentName(e),a=t.typeManager.getNameByIndex(e[i.TYPE]),o=e.concat();o[i.X]+=t.from,t.transactionData.push(o),t.transactionDataByAgent[n].push(o),t.countByType[n][a]++}))}},{key:"getAgentName",value:function(t){return"string"==typeof t?this.agentMetadata[t][a.AGENT_NAME]:this.agentMetadata[t[i.META]][a.AGENT_NAME]}},{key:"getDataByAgentAndIndex",value:function(t,e){return this.transactionDataByAgent[t][e]}},{key:"getGroupCount",value:function(t){return t[i.GROUP_COUNT]}},{key:"getDataByIndex",value:function(t){return this.transactionData[t]}},{key:"getTotalCount",value:function(){return this.transactionData.length}},{key:"countByAgent",value:function(t){return this.transactionDataByAgent[t]?this.transactionDataByAgent[t].length:0}},{key:"getCount",value:function(t,e,n,i){var a=this;if(n&&i)return this.getCountOfRange(t,e,n,i);if(""===t){var o=0;return Object.keys(this.countByType).forEach((function(t){o+=a.countByType[t][e]})),o}return this.countByType[t]?this.countByType[t][e]:0}},{key:"getCountOfRange",value:function(t,e,n,a){var o=0,s=this.transactionDataByAgent[t].length;if(this.fromX>=a||this.toX<=n||0===s||t in this.countByType==0)return o;if(this.fromX>=n&&this.toX<=a)return this.getCount(t,e);for(var r=0;r<s;r++){var l=this.transactionDataByAgent[t][r];if(l[i.X]<n)break;e===this.typeManager.getNameByIndex(l[i.TYPE])&&l[i.X]<=a&&o++}return o}},{key:"getTransactionID",value:function(t){var e=this.agentMetadata[t[i.META]];return"".concat(e[a.TRANSACTION_PREFIX_1],"^").concat(e[a.TRANSACTION_PREFIX_2],"^").concat(t[i.TRANSACTION_ID])}},{key:"getX",value:function(t){return t[i.X]}},{key:"getY",value:function(t){return t[i.Y]}},{key:"getTypeIndex",value:function(t){return t[i.TYPE]}},{key:"getXRange",value:function(){return{from:this.fromX,to:this.toX}}},{key:"isEmpty",value:function(){return 0===this.transactionData.length}},{key:"getAgentList",value:function(){return this.agentList}}]),t}()},"7fKh":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("8Y7J"),a=n("REft"),o=function(){function t(){_classCallCheck(this,t),this.outChanged=new i.EventEmitter}return _createClass(t,[{key:"ngOnInit",value:function(){this.transactionTypeInfo=a.a.getDefaultTransactionTypeInfo(),this.sortTypeInfo()}},{key:"ngOnChanges",value:function(t){var e=this;this.transactionTypeCount&&this.transactionTypeInfo&&Object.keys(this.transactionTypeCount).forEach((function(t){e.transactionTypeInfo[t].checked=e.transactionTypeCount[t].checked}))}},{key:"sortTypeInfo",value:function(){var t=this;this.sortedKeyArr=[];var e=[];Object.keys(this.transactionTypeInfo).forEach((function(n){e.push(t.transactionTypeInfo[n])})),e.sort((function(t,e){return t.order-e.order})).forEach((function(e){t.sortedKeyArr.push(e.name)}))}},{key:"upperFirstChar",value:function(t){return t?t.substr(0,1).toUpperCase()+t.substr(1):""}},{key:"getTypeCount",value:function(t){return this.transactionTypeCount&&this.transactionTypeCount[t]?this.transactionTypeCount[t].count:0}},{key:"onCheck",value:function(t){this.transactionTypeInfo[t].checked=!this.transactionTypeInfo[t].checked,this.outChanged.emit({instanceKey:this.instanceKey,name:t,checked:this.transactionTypeInfo[t].checked})}}]),t}()},Ea0K:function(t,e,n){"use strict";var i=n("8Y7J"),a=n("hNim");n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var o=i["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{width:100%;z-index:1000;position:absolute}.l-chart-setting[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:60%;border:1px solid #e5e8f0;text-align:left;box-shadow:1px 1px 10px rgba(0,0,0,.15);background:#fff;margin:15% 20%}.l-title-group[_ngcontent-%COMP%]{height:auto;padding:10px 20px;background-color:#fff}.l-title-group[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{color:var(--primary-color);font-size:20px;font-weight:600}.l-contents-group[_ngcontent-%COMP%]{padding:20px 20px 15px}.l-contents-group[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:5px 0 0;font-size:13px;font-weight:600}.l-contents-group[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:50%;display:inline-block}.l-contents-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid #d7dde4;font-size:13px;color:#666;height:22px;padding:0 8px}.l-bottom-group[_ngcontent-%COMP%]{text-align:center;margin:0 0 20px}input[_ngcontent-%COMP%]{color:#666;width:40%;height:22px;border:1px solid #d7dde4;padding:0 8px;font-size:13px}"]],data:{}});function s(t){return i["\u0275vid"](0,[i["\u0275qud"](402653184,1,{minInput:0}),i["\u0275qud"](402653184,2,{maxInput:0}),(t()(),i["\u0275eld"](2,0,null,null,19,"article",[["class","l-chart-setting"]],null,null,null,null,null)),(t()(),i["\u0275eld"](3,0,null,null,3,"div",[["class","l-title-group"]],null,null,null,null,null)),(t()(),i["\u0275eld"](4,0,null,null,2,"dl",[],null,null,null,null,null)),(t()(),i["\u0275eld"](5,0,null,null,1,"dt",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Setting"])),(t()(),i["\u0275eld"](7,0,null,null,9,"div",[["class","l-contents-group"]],null,null,null,null,null)),(t()(),i["\u0275eld"](8,0,null,null,8,"ul",[],null,null,null,null,null)),(t()(),i["\u0275eld"](9,0,null,null,3,"li",[],null,null,null,null,null)),(t()(),i["\u0275eld"](10,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Min of Y axis"])),(t()(),i["\u0275eld"](12,0,[[1,0],["minInput",1]],null,0,"input",[["min","0"],["type","number"]],[[8,"value",0]],null,null,null,null)),(t()(),i["\u0275eld"](13,0,null,null,3,"li",[],null,null,null,null,null)),(t()(),i["\u0275eld"](14,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Max of Y axis"])),(t()(),i["\u0275eld"](16,0,[[2,0],["maxInput",1]],null,0,"input",[["min","0"],["type","number"]],[[8,"value",0]],null,null,null,null)),(t()(),i["\u0275eld"](17,0,null,null,4,"div",[["class","l-bottom-group"]],null,null,null,null,null)),(t()(),i["\u0275eld"](18,0,null,null,1,"button",[["class","active btn"]],null,[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.onApply()&&i),i}),null,null)),(t()(),i["\u0275ted"](-1,null,["Apply"])),(t()(),i["\u0275eld"](20,0,null,null,1,"button",[["class","btn"]],null,[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.onCancel()&&i),i}),null,null)),(t()(),i["\u0275ted"](-1,null,["Cancel"]))],null,(function(t,e){var n=e.component;t(e,12,0,i["\u0275inlineInterpolate"](1,"",n.min,"")),t(e,16,0,i["\u0275inlineInterpolate"](1,"",n.max,""))}))}i["\u0275ccf"]("pp-scatter-chart-setting-popup",a.a,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"pp-scatter-chart-setting-popup",[],null,null,null,s,o)),i["\u0275did"](1,114688,null,0,a.a,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{instanceKey:"instanceKey",min:"min",max:"max"},{outApply:"outApply",outCancel:"outCancel"},[])},"O/DK":function(t,e,n){"use strict";var i=n("8Y7J"),a=n("SVse"),o=n("dryN"),s=n("OsX8"),r=n("zw4y");n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var l=i["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;height:100%}.l-wrapper[_ngcontent-%COMP%]{display:block}.l-scatter[_ngcontent-%COMP%]{width:100%;height:100%;display:block;position:relative}.l-message[_ngcontent-%COMP%]{top:0;width:100%;height:100%;display:-webkit-box;display:flex;position:absolute;text-align:center;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.l-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600}canvas[_ngcontent-%COMP%]{width:100%;height:100%}"]],data:{}});function c(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,2,"div",[["class","l-message"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),i["\u0275ted"](-1,null,["Loading..."]))],null,null)}function u(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,2,"div",[["class","l-message"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),i["\u0275ted"](2,null,["",""]))],null,(function(t,e){t(e,2,0,e.component.getMessage())}))}function h(t){return i["\u0275vid"](0,[i["\u0275qud"](402653184,1,{elementScatter:0}),(t()(),i["\u0275eld"](1,0,null,null,5,"div",[["class","l-wrapper"]],null,null,null,null,null)),(t()(),i["\u0275eld"](2,0,[[1,0],["scatter",1]],null,0,"div",[["class","l-scatter"]],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,1,null,c)),i["\u0275did"](4,16384,null,0,a.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),i["\u0275and"](16777216,null,null,1,null,u)),i["\u0275did"](6,16384,null,0,a.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(t,e){var n=e.component;t(e,4,0,!n.dataLoaded),t(e,6,0,!n.hideNoData())}),null)}i["\u0275ccf"]("pp-scatter-chart",o.a,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"pp-scatter-chart",[],null,null,null,h,l)),i["\u0275did"](1,770048,null,0,o.a,[s.a,r.a],null,null)],(function(t,e){t(e,1,0)}),null)}),{instanceKey:"instanceKey",addWindow:"addWindow",width:"width",height:"height",fromX:"fromX",toX:"toX",fromY:"fromY",toY:"toY",mode:"mode",application:"application",agent:"agent",i18nText:"i18nText",timezone:"timezone",dateFormat:"dateFormat"},{outTransactionCount:"outTransactionCount",outSelectArea:"outSelectArea",outChangeRangeX:"outChangeRangeX"},[])},R0vR:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("IheW"),a=n("XNiG"),o=n("jtHE"),s=n("LRne"),r=n("eIep"),l=n("un/a"),c=n("pLZG"),u=n("3E0/"),h=n("ueBd"),d=function(){function t(e){_classCallCheck(this,t),this.http=e,this.url="getScatterData.pinpoint",this.realtime={interval:2e3,resetTimeGap:2e4},this.loadStart=!0,this.innerDataRequest=new a.b,this.innerRealTimeDataRequest=new a.b,this.outScatterData=new a.b,this.savedScatterData=new o.a,this.outRealTimeScatterData=new a.b,this.outScatterErrorData=new a.b,this.outRealTimeScatterErrorData=new a.b,this.outScatterData$=this.outScatterData.asObservable(),this.outScatterErrorData$=this.outScatterErrorData.asObservable(),this.outRealTimeScatterData$=this.outRealTimeScatterData.asObservable(),this.outRealTimeScatterErrorData$=this.outRealTimeScatterErrorData.asObservable(),this.savedScatterData$=this.savedScatterData.asObservable(),this.connectDataRequest()}return _createClass(t,[{key:"connectDataRequest",value:function(){var t=this;this.innerDataRequest.pipe(Object(r.a)((function(e){return t.requestHttp(e).pipe(Object(l.a)(3),Object(c.a)((function(t){return!Object(h.c)(t,"exception")})))}))).subscribe((function(e){t.subscribeStaticRequest(e)}),(function(e){t.outScatterErrorData.next(e)})),this.innerRealTimeDataRequest.pipe(Object(c.a)((function(){return t.loadStart})),Object(r.a)((function(e){return t.requestHttp(e).pipe(Object(l.a)(3))}))).subscribe((function(e){t.subscribeRealTimeRequest(e)}),(function(t){}))}},{key:"requestHttp",value:function(t){return this.http.get(this.url,this.makeRequestOptionsArgs(t.application,t.fromX,t.toX,t.groupUnitX,t.groupUnitY,t.backwardDirection))}},{key:"getData",value:function(t,e,n){this.requestTime=Date.now();var i={application:this.application,fromX:t,toX:e,groupUnitX:this.groupUnitX,groupUnitY:this.groupUnitY,backwardDirection:n};return this.innerDataRequest.next(i)}},{key:"getRealTimeData",value:function(t,e,n){this.requestTime=Date.now();var i={application:this.application,fromX:t,toX:e,groupUnitX:this.groupUnitX,groupUnitY:this.groupUnitY,backwardDirection:n};return this.innerRealTimeDataRequest.next(i)}},{key:"loadData",value:function(t,e,n,i,a,s){this.application=t,this.groupUnitX=i,this.groupUnitY=a,!1!==s&&(this.savedScatterData.complete(),this.savedScatterData=new o.a,this.savedScatterData$=this.savedScatterData.asObservable()),this.getData(e,n,!0)}},{key:"subscribeStaticRequest",value:function(t){this.savedScatterData.next(t),this.outScatterData.next(t)}},{key:"getSavedData",value:function(){return this.savedScatterData$}},{key:"loadRealTimeData",value:function(t,e,n,i,a){this.loadStart=!0,this.application=t,this.groupUnitX=i,this.groupUnitY=a}},{key:"loadRealTimeDataV2",value:function(t){var e=this;this.loadStart=!0,Object(s.a)(1).pipe(Object(u.a)(this.realtime.interval)).subscribe((function(n){e.getRealTimeData(t,t+e.realtime.interval,!1)}))}},{key:"stopLoad",value:function(){this.loadStart=!1}},{key:"isConnected",value:function(){return this.loadStart}},{key:"subscribeRealTimeRequest",value:function(t){var e=this,n=Date.now()-this.requestTime,i=0,a=0,o=this.realtime.interval-n;if(t.complete)if(i=t.to,a=i+this.realtime.interval,o>0){var r=t.currentServerTime-a;r>=o&&(o=r>=this.realtime.interval?0:Math.min(Math.abs(r),o))}else o=0;else i=t.from,a=t.resultFrom,o=0;t.currentServerTime-a>=this.realtime.resetTimeGap?(t.reset=!0,this.outRealTimeScatterData.next(t)):(this.outRealTimeScatterData.next(t),Object(s.a)(1).pipe(Object(u.a)(o)).subscribe((function(t){e.getRealTimeData(i,a,!1)})))}},{key:"makeRequestOptionsArgs",value:function(t,e,n,a,o,s){return{params:(new i.h).set("application",t).set("from",e+"").set("to",n+"").set("limit","5000").set("filter","").set("xGroupUnit",a+"").set("yGroupUnit",o+"").set("backwardDirection",s+"")}}}]),t}()},R4Tc:function(t,e,n){"use strict";var i=n("8Y7J"),a=n("SVse"),o=n("7fKh");n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return l}));var s=i["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block}.l-checkbox-group[_ngcontent-%COMP%]{color:#b3b3b4;margin:24px 0 0;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;font-size:12px;justify-content:space-around}.l-checkbox-group[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#333;font-size:22px}.l-checkbox-group[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]:before{width:13px;height:13px;margin:0 6px 0 0;content:'';display:inline-block;background:#34b994;border-radius:50%}.l-checkbox-group[_ngcontent-%COMP%]   .failed[_ngcontent-%COMP%]:before{width:13px;height:13px;margin:0 6px 0 0;content:'';display:inline-block;background:#e95459;border-radius:50%}input[_ngcontent-%COMP%]{margin-left:10px}"]],data:{}});function r(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,6,"div",[],[[8,"className",0]],null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,4,"label",[],[[8,"htmlFor",0]],null,null,null,null)),(t()(),i["\u0275ted"](2,null,[" "," "])),(t()(),i["\u0275eld"](3,0,null,null,2,"span",[],null,null,null,null,null)),(t()(),i["\u0275ted"](4,null,["",""])),i["\u0275ppd"](5,1),(t()(),i["\u0275eld"](6,0,null,null,0,"input",[["type","checkbox"]],[[8,"id",0],[8,"checked",0],[8,"value",0]],[[null,"change"]],(function(t,e,n){var i=!0,a=t.component;return"change"===e&&(i=!1!==a.onCheck(t.context.$implicit)&&i),i}),null,null))],null,(function(t,e){var n=e.component;t(e,0,0,i["\u0275inlineInterpolate"](1,"",e.context.$implicit,"")),t(e,1,0,i["\u0275inlineInterpolate"](1,"",e.context.$implicit,"-id")),t(e,2,0,n.upperFirstChar(e.context.$implicit));var a=i["\u0275unv"](e,4,0,t(e,5,0,i["\u0275nov"](e.parent,0),n.getTypeCount(e.context.$implicit)));t(e,4,0,a),t(e,6,0,i["\u0275inlineInterpolate"](1,"",e.context.$implicit,"-id"),n.transactionTypeInfo[e.context.$implicit].checked,i["\u0275inlineInterpolate"](1,"",e.context.$implicit,""))}))}function l(t){return i["\u0275vid"](0,[i["\u0275pid"](0,a.DecimalPipe,[i.LOCALE_ID]),(t()(),i["\u0275eld"](1,0,null,null,2,"div",[["class","l-checkbox-group"]],null,null,null,null,null)),(t()(),i["\u0275and"](16777216,null,null,1,null,r)),i["\u0275did"](3,278528,null,0,a.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(t,e){t(e,3,0,e.component.sortedKeyArr)}),null)}i["\u0275ccf"]("pp-scatter-chart-state-view",o.a,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"pp-scatter-chart-state-view",[],null,null,null,l,s)),i["\u0275did"](1,638976,null,0,o.a,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{instanceKey:"instanceKey",transactionTypeCount:"transactionTypeCount"},{outChanged:"outChanged"},[])},REft:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(e){_classCallCheck(this,t),this.transactionTypeInfo=e,this.dataByIndex={},this.dataByName={},this.initData()}return _createClass(t,[{key:"initData",value:function(){var t=this;Object.keys(this.transactionTypeInfo).forEach((function(e){var n=Object.assign({},t.transactionTypeInfo[e]);t.dataByName[e]=n,t.dataByIndex[n.dataIndex]=n}))}},{key:"reset",value:function(){this.initData()}},{key:"getTypeNameList",value:function(){return Object.keys(this.dataByName)}},{key:"setChecked",value:function(t,e){this.dataByName[t].checked=e}},{key:"isCheckedByName",value:function(t){return this.dataByName[t].checked}},{key:"isCheckedByIndex",value:function(t){return this.dataByIndex[t].checked}},{key:"getColorByIndex",value:function(t){return this.dataByIndex[t].color}},{key:"getColorByName",value:function(t){return this.dataByName[t].color}},{key:"getNameByIndex",value:function(t){return this.dataByIndex[t].name}},{key:"getCheckedTypeNameList",value:function(){var t=this,e=[];return Object.keys(this.dataByName).forEach((function(n){t.dataByName[n].checked&&e.push(n)})),e}}],[{key:"getTypeCheckValue",value:function(t,e){return t?{name:"success",checked:!1}:e?{name:"failed",checked:!1}:void 0}},{key:"getDefaultTransactionTypeInfo",value:function(){return{success:{name:"success",order:10,color:"#34B994",checked:!0,dataIndex:1},failed:{name:"failed",order:20,color:"#E95459",checked:!0,dataIndex:0}}}}]),t}()},dryN:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("8Y7J"),a=n("XNiG"),o=n("1G5W"),s=n("pLZG"),r=(n("ZF+8"),n("xvpG")),l=n("/n0m");n("zw4y");var c=function(){function t(e,n){_classCallCheck(this,t),this.windowRefService=e,this.scatterChartInteractionService=n,this.outTransactionCount=new i.EventEmitter,this.outSelectArea=new i.EventEmitter,this.outChangeRangeX=new i.EventEmitter,this.BLOCK_MAX_SIZE=500,this.unsubscribe=new a.b,this.hasError=!1,this.dataLoaded=!1,this.scatterChartInstance=null}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.mode&&this.fromX>=0&&this.toX>=0&&this.fromY>=0&&this.toY>=0&&this.application&&this.timezone&&this.dateFormat&&(null===this.scatterChartInstance?(this.scatterChartInstance=new r.a(this.mode,this.elementScatter.nativeElement,this.fromX,this.toX,this.fromY,this.toY,this.application,this.agent,this.width,this.height,this.timezone,this.dateFormat),this.addSubscribeForInstance(),this.addSubscribeForService(),this.addToWindow()):(t.timezone&&t.timezone.currentValue&&(this.scatterChartInstance.setTimezone(this.timezone),this.scatterChartInstance.redraw()),t.dateFormat&&t.dateFormat.currentValue&&(this.scatterChartInstance.setDateFormat(this.dateFormat),this.scatterChartInstance.redraw())))}},{key:"addToWindow",value:function(){this.addWindow&&("scatterChartInstance"in this.windowRefService.nativeWindow==0&&(this.windowRefService.nativeWindow.scatterChartInstance={}),this.windowRefService.nativeWindow.scatterChartInstance[this.application]=this.scatterChartInstance)}},{key:"addSubscribeForInstance",value:function(){var t=this;this.scatterChartInstance.onSelect$.pipe(Object(o.a)(this.unsubscribe)).subscribe((function(e){t.outSelectArea.emit(e)})),this.scatterChartInstance.onChangeTransactionCount$.pipe(Object(o.a)(this.unsubscribe)).subscribe((function(e){t.outTransactionCount.emit(e)})),this.scatterChartInstance.onChangeRangeX$.pipe(Object(o.a)(this.unsubscribe)).subscribe((function(e){t.outChangeRangeX.emit(e)}))}},{key:"addSubscribeForService",value:function(){var t=this;this.scatterChartInteractionService.onChartData$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e.instanceKey===t.instanceKey}))).subscribe((function(e){var n=t.scatterChartInstance.getTypeManager(),i=e.data.scatter.dotList.length;if(i>t.BLOCK_MAX_SIZE){var a=e.data.from,o=e.data.to,s=0,r=Math.min(i,t.BLOCK_MAX_SIZE)-1;do{t.scatterChartInstance.addData(new l.b({complete:!1,currentServerTime:e.data.currentServerTime,from:a,resultFrom:e.data.scatter.dotList[r][0]+a,resultTo:e.data.scatter.dotList[s][0]+a,scatter:{dotList:e.data.scatter.dotList.slice(s,r+1),metadata:e.data.scatter.metadata},to:o},n)),s=r+1,r=Math.min(i,s+t.BLOCK_MAX_SIZE)-1}while(s<i)}else t.scatterChartInstance.addData(new l.b(e.data,n));t.dataLoaded=!0,t.hasError=!1})),this.scatterChartInteractionService.onViewType$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e.instanceKey===t.instanceKey}))).subscribe((function(e){t.scatterChartInstance.changeShowType(e)})),this.scatterChartInteractionService.onChangeYRange$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e.instanceKey===t.instanceKey}))).subscribe((function(e){t.scatterChartInstance.changeYRange(e)})),this.scatterChartInteractionService.onSelectedAgent$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e.instanceKey===t.instanceKey}))).subscribe((function(e){t.scatterChartInstance.changeSelectedAgent(e.agent)})),this.scatterChartInteractionService.onInvokeDownloadChart$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e===t.instanceKey}))).subscribe((function(){t.scatterChartInstance.downloadChartAsImage("png")})),this.scatterChartInteractionService.onReset$.pipe(Object(o.a)(this.unsubscribe),Object(s.a)((function(e){return e.instanceKey===t.instanceKey}))).subscribe((function(e){t.hasError=!1,t.dataLoaded=!1,t.application=e.application,t.agent=e.agent,t.fromX=e.from,t.toX=e.to,t.mode=e.mode,t.scatterChartInstance.reset(e.application,e.agent,e.from,e.to,e.mode),t.addToWindow()})),this.scatterChartInteractionService.onError$.pipe(Object(o.a)(this.unsubscribe)).subscribe((function(e){t.hasError=!0,t.dataLoaded=!0,t.scatterChartInstance.reset(t.application,t.agent,t.fromX,t.toX,t.mode),t.addToWindow()}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"hideNoData",value:function(){return!1===this.dataLoaded||this.mode===r.a.MODE.REALTIME||this.scatterChartInstance&&!this.scatterChartInstance.isEmpty()}},{key:"getMessage",value:function(){return this.hasError?this.i18nText.FAILED_TO_FETCH_DATA:this.i18nText.NO_DATA}}]),t}()},erdE:function(t,e,n){"use strict";var i=n("8Y7J"),a=n("hiii");n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var o=i["\u0275crt"]({encapsulation:0,styles:[[".l-tool-box[_ngcontent-%COMP%]{font-size:14px;color:#b3b5b9;text-align:right;position:relative;padding:0 25px}.l-tool-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 0 0 14px}.fas[_ngcontent-%COMP%], .l-tool-box[_ngcontent-%COMP%]   button.l-last-child[_ngcontent-%COMP%]{font-size:18px}"]],data:{}});function s(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,4,"div",[["class","l-tool-box"]],null,null,null,null,null)),(t()(),i["\u0275eld"](1,0,null,null,0,"button",[["class","fas fa-cog"]],[[8,"hidden",0]],[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.outShowSetting.emit()&&i),i}),null,null)),(t()(),i["\u0275eld"](2,0,null,null,0,"button",[["class","fas fa-download"]],[[8,"hidden",0]],[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.outDownload.emit()&&i),i}),null,null)),(t()(),i["\u0275eld"](3,0,null,null,0,"button",[["class","fas fa-expand-arrows-alt"]],[[8,"hidden",0]],[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.outOpenScatterPage.emit()&&i),i}),null,null)),(t()(),i["\u0275eld"](4,0,null,null,0,"button",[["class","fas fa-question-circle l-last-child"]],[[8,"hidden",0]],[[null,"click"]],(function(t,e,n){var i=!0,a=t.component;return"click"===e&&(i=!1!==a.onShowHelp(n)&&i),i}),null,null))],null,(function(t,e){var n=e.component;t(e,1,0,n.hiddenOptions.setting),t(e,2,0,n.hiddenOptions.download),t(e,3,0,n.hiddenOptions.open),t(e,4,0,n.hiddenOptions.help)}))}i["\u0275ccf"]("pp-scatter-chart-options",a.a,(function(t){return i["\u0275vid"](0,[(t()(),i["\u0275eld"](0,0,null,null,1,"pp-scatter-chart-options",[],null,null,null,s,o)),i["\u0275did"](1,114688,null,0,a.a,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{instanceKey:"instanceKey",hiddenOptions:"hiddenOptions"},{outShowSetting:"outShowSetting",outDownload:"outDownload",outOpenScatterPage:"outOpenScatterPage",outShowHelp:"outShowHelp"},[])},hNim:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("8Y7J"),a=function(){function t(){_classCallCheck(this,t),this.outApply=new i.EventEmitter,this.outCancel=new i.EventEmitter}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onApply",value:function(){this.min=Number.parseInt(this.minInput.nativeElement.value,10),this.max=Number.parseInt(this.maxInput.nativeElement.value,10),this.outApply.emit({key:this.instanceKey,min:this.min,max:this.max})}},{key:"onCancel",value:function(){this.minInput.nativeElement.value=this.min,this.maxInput.nativeElement.value=this.max,this.outCancel.emit()}}]),t}()},hiii:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("8Y7J"),a=function(){function t(){_classCallCheck(this,t),this.outShowSetting=new i.EventEmitter,this.outDownload=new i.EventEmitter,this.outOpenScatterPage=new i.EventEmitter,this.outShowHelp=new i.EventEmitter}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onShowHelp",value:function(t){this.outShowHelp.emit(t)}}]),t}()},l5mm:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("HDdC"),a=n("D0XW"),o=n("Y7HM");function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a;return(!Object(o.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=a.a),new i.a((function(n){return n.add(e.schedule(r,t,{subscriber:n,counter:0,period:t})),n}))}function r(t){var e=t.subscriber,n=t.counter,i=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:i},i)}},nZAD:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function t(){_classCallCheck(this,t)}},xvpG:function(t,e,n){"use strict";var i=n("f0Wu"),a=n("XNiG"),o=n("2Vo4"),s=function(){function t(e){_classCallCheck(this,t),this.options=e,this.initVar()}return _createClass(t,[{key:"initVar",value:function(){var t=this.options.bubbleRadius;this.initFromX=this.options.x.from,this.widthOfChartSpace=this.options.width-(this.options.padding.left+this.options.padding.right)-2*t,this.heightOfChartSpace=this.options.height-(this.options.padding.top+this.options.padding.bottom)-2*t,this.calcuUnitValue()}},{key:"calcuUnitValue",value:function(){this.timePerPixel=this.getGapX()/this.widthOfChartSpace,this.pixelPerTime=this.widthOfChartSpace/this.getGapX()}},{key:"getInitFromX",value:function(){return this.initFromX}},{key:"getLeftPadding",value:function(){return this.options.padding.left}},{key:"getTopPadding",value:function(){return this.options.padding.top}},{key:"getCanvasWidth",value:function(){return this.widthOfChartSpace}},{key:"getWidth",value:function(){return this.options.width}},{key:"getHeight",value:function(){return this.options.height}},{key:"getX",value:function(){return{from:this.options.x.from,to:this.options.x.to}}},{key:"resetInitX",value:function(t){this.initFromX=t}},{key:"setX",value:function(t,e,n){this.options.x.from=t,this.options.x.to=e,this.calcuUnitValue()}},{key:"getY",value:function(){return{from:this.options.y.from,to:this.options.y.to}}},{key:"setY",value:function(t,e){this.options.y.from=t,this.options.y.to=e}},{key:"getPadding",value:function(){return{top:this.options.padding.top,left:this.options.padding.left,right:this.options.padding.right,bottom:this.options.padding.bottom}}},{key:"getBubbleHalfSize",value:function(){return this.options.bubbleRadius}},{key:"getBubbleSize",value:function(){return 2*this.options.bubbleRadius}},{key:"getWidthOfChartSpace",value:function(){return this.widthOfChartSpace}},{key:"getHeightOfChartSpace",value:function(){return this.heightOfChartSpace}},{key:"getPixelPerTime",value:function(){return this.pixelPerTime}},{key:"getTimePerPixel",value:function(){return this.timePerPixel}},{key:"parseXDataToXChart",value:function(t,e){return Math.round((t-this.options.x.from)/this.getGapX()*this.widthOfChartSpace)+this.getBubbleHalfSize()+(e?this.options.padding.left:0)}},{key:"parseYDataToYChart",value:function(t){return Math.round(this.heightOfChartSpace-(t-this.options.y.from)/this.getGapY()*this.heightOfChartSpace)+this.getBubbleHalfSize()}},{key:"parseZDataToZChart",value:function(t){return Math.round((t-this.options.z.from)/this.getGapZ()*this.getBubbleHalfSize())}},{key:"getXOfPixel",value:function(){return Math.round(this.getGapX()/this.widthOfChartSpace)}},{key:"getYOfPixel",value:function(){return Math.round(this.getGapY()/this.heightOfChartSpace)}},{key:"parseMouseXToXData",value:function(t){return Math.round(t/this.widthOfChartSpace*this.getGapX())+this.options.x.from}},{key:"parseMouseYToYData",value:function(t){return Math.round(this.options.y.from+t/this.heightOfChartSpace*this.getGapY())}},{key:"getGapX",value:function(){return this.options.x.to-this.options.x.from}},{key:"getGapY",value:function(){return this.options.y.to-this.options.y.from}},{key:"getGapZ",value:function(){return this.options.z.to-this.options.z.from}}]),t}(),r=n("/n0m"),l=function(){function t(e,n,i,a){_classCallCheck(this,t),this.options=e,this.coordinateManager=n,this.elementContainer=i,this.typeManager=a,this.initVariable(),this.initCanvasWrapper()}return _createClass(t,[{key:"initVariable",value:function(){this.canvasMap={},this.ctxMap={}}},{key:"initCanvasWrapper",value:function(){var t=100,e=this.coordinateManager.getBubbleSize(),n=this.coordinateManager.getBubbleHalfSize(),i=this.coordinateManager.getWidthOfChartSpace(),a=this.coordinateManager.getHeightOfChartSpace();this.elementScroller=document.createElement("div"),this.elementScroller.setAttribute("style","top: 0px; left: 0px; position: absolute; background-color: grey; height:"+(a+e)+"px"),this.elementScroller.setAttribute("class","canvas-scroller");var o=document.createElement("div"),s="\n            top: ".concat(this.coordinateManager.getTopPadding(),"px;\n            left: ").concat(this.coordinateManager.getLeftPadding()+n,"px;\n            width: ").concat(i,"px;\n            height: ").concat(a+e,"px;\n            z-index: ").concat(t++,";\n            overflow: hidden;\n            position: absolute;\n        ");o.setAttribute("class","canvas-wrapper"),o.setAttribute("style",s),o.appendChild(this.elementScroller),this.elementContainer.appendChild(o)}},{key:"makeDataCanvas",value:function(t,e){var n=this,i=110,a=this.coordinateManager.getBubbleSize(),o=this.options.prefix,s=this.coordinateManager.getHeightOfChartSpace(),r=this.coordinateManager.getCanvasWidth();e.forEach((function(t,e){n.typeManager.getTypeNameList().forEach((function(e){var l="".concat(t,"-").concat(o,"-").concat(e);if(l in n.canvasMap==0){var c=n.createCanvas({width:r+"px",height:s+a+"px","data-agent":t,"data-type":e,"data-key":l},"\n                        top: 0px;\n                        left: 0px;\n                        z-index: ".concat(i++,";\n                        position: absolute;\n                    ")),u=n.createCanvas({width:r+"px",height:s+a+"px","data-agent":t,"data-type":e,"data-key":l},"\n                        top: 0px;\n                        left: ".concat(r,"px;\n                        z-index: ").concat(i++,";\n                        position: absolute;\n                    "));n.elementScroller.appendChild(c),n.elementScroller.appendChild(u),n.canvasMap[l]=[c,u],n.ctxMap[l]=[c.getContext("2d"),u.getContext("2d")]}}))})),this.scrollOrder=[0,1]}},{key:"createCanvas",value:function(t,e){var n=document.createElement("canvas");return Object.keys(t).forEach((function(e){n.setAttribute(e,t[e])})),n.setAttribute("style",e),n}},{key:"setTypeView",value:function(t,e,n){var i=this,a=n?"block":"none";Object.keys(this.canvasMap).forEach((function(t){i.canvasMap[t].forEach((function(n){t.endsWith(e)&&(n.style.display=a)}))}))}},{key:"toggle",value:function(t,e,n){var i=this;Object.keys(this.canvasMap).forEach((function(a){i.canvasMap[a].forEach((function(i){(t||a.startsWith(e))&&a.endsWith(n)&&("none"===i.style.display?i.style.display="block":i.style.display="none")}))}))}},{key:"showSelectedAgent",value:function(t){var e=this;""===t?Object.keys(this.canvasMap).forEach((function(t){e.canvasMap[t].forEach((function(n){e.typeManager.isCheckedByName(t.split("-").pop())?n.style.display="block":n.style.display="none"}))})):Object.keys(this.canvasMap).forEach((function(n){n.startsWith(t)?e.canvasMap[n].forEach((function(t){e.typeManager.isCheckedByName(n.split("-").pop())&&(t.style.display="block")})):e.canvasMap[n].forEach((function(t){t.style.display="none"}))}))}},{key:"drawTransaction",value:function(t,e,n){var i=this.options.bubbleRadius,a=this.coordinateManager.getY(),o=(n[r.a.X]-this.coordinateManager.getInitFromX())*this.coordinateManager.getPixelPerTime(),s=this.coordinateManager.parseYDataToYChart(Math.min(a.to,Math.max(a.from,n[r.a.Y]))),l=this.coordinateManager.parseZDataToZChart(i),c=this.scrollOrder[0],u=this.coordinateManager.getCanvasWidth(),h=Math.round(parseInt(this.canvasMap[t][c].style.left,10)),d=h+u;o>d?(c=this.scrollOrder[1],o-=d):o-=h,this.ctxMap[t][c].beginPath(),this.ctxMap[t][c].fillStyle=e,this.ctxMap[t][c].strokeStyle=e,this.ctxMap[t][c].arc(o,s,l,0,2*Math.PI,!0),this.ctxMap[t][c].globalAlpha=.3+.1*n[r.a.GROUP_COUNT],this.ctxMap[t][c].fill()}},{key:"moveChart",value:function(t,e){var n=this.coordinateManager.getCanvasWidth(),i=this.coordinateManager.getHeight(),a=parseInt(this.elementScroller.style.left,10),o=a-t,s=this,r=-1;this.requestAnimationFrameRef=window.requestAnimationFrame((function(e){r=e,function t(e,l,c){var u=e-r,h=u/c;if(h=Math.min(h,1),s.elementScroller.style.left=(a+-l*h).toFixed(2)+"px",u<c)s.requestAnimationFrameRef=window.requestAnimationFrame((function(e){t(e,l,c)}));else{var d=s.scrollOrder[0],p=s.scrollOrder[1],g=!1;Object.keys(s.canvasMap).forEach((function(t){var e=s.canvasMap[t];Math.abs(o)>parseInt(e[d].style.left,10)+n&&(g=!0,e[d].style.left=parseInt(e[p].style.left,10)+n+"px",s.ctxMap[t][d].clearRect(0,0,n,i))})),g&&(s.scrollOrder[0]=p,s.scrollOrder[1]=d)}}(e,t,300)}))}},{key:"reset",value:function(){window.cancelAnimationFrame(this.requestAnimationFrameRef),this.scrollOrder=[0,1],this.elementScroller.style.left="0px",this.elementScroller.innerHTML="",this.initVariable()}},{key:"clear",value:function(){var t=this,e=this.coordinateManager.getCanvasWidth(),n=this.coordinateManager.getHeight();Object.keys(this.ctxMap).forEach((function(i){t.ctxMap[i].forEach((function(t){t.clearRect(0,0,e,n)}))}))}},{key:"drawToCanvas",value:function(t,e){var n=this,i=this.coordinateManager.getPadding(),a=this.coordinateManager.getBubbleHalfSize();return Object.keys(this.canvasMap).forEach((function(o){n.canvasMap[o].forEach((function(n){"none"!==n.style.display&&t.drawImage(n,i.left+a,i.top+e)}))})),t.textBaseline="top",t}}]),t}(),c=function(){function t(e,n,i){_classCallCheck(this,t),this.options=e,this.coordinateManager=n,this.elementContainer=i,this.ticksX=this.options.ticks.x-1,this.ticksY=this.options.ticks.y-1,this.makeGridCanvas(),this.drawGridLine()}return _createClass(t,[{key:"makeGridCanvas",value:function(){this.elementGridCanvas=document.createElement("canvas"),this.elementGridCanvas.setAttribute("width",this.coordinateManager.getWidth()+"px"),this.elementGridCanvas.setAttribute("height",this.coordinateManager.getHeight()+"px"),this.elementGridCanvas.setAttribute("style","top: 0px; z-index: 0; position: absolute"),this.elementContainer.appendChild(this.elementGridCanvas),this.ctxGridCanvas=this.elementGridCanvas.getContext("2d")}},{key:"drawGridLine",value:function(){this.setStyle(this.ctxGridCanvas,this.options.gridAxisStyle),this.drawXGridLine(),this.drawYGridLine()}},{key:"drawXGridLine",value:function(){for(var t=this.coordinateManager.getHeight(),e=this.coordinateManager.getPadding(),n=this.coordinateManager.getBubbleHalfSize(),i=this.coordinateManager.getWidthOfChartSpace()/this.ticksX,a=e.left+n,o=e.top,s=t-e.bottom,r=0;r<=this.ticksX;r++){var l=a+i*r;this.drawLine(this.ctxGridCanvas,l,o,l,s)}}},{key:"drawYGridLine",value:function(){for(var t=this.coordinateManager.getWidth(),e=this.coordinateManager.getHeight(),n=this.coordinateManager.getPadding(),i=this.coordinateManager.getBubbleHalfSize(),a=this.coordinateManager.getHeightOfChartSpace()/this.ticksY,o=n.left,s=t-n.right,r=n.bottom+i,l=0;l<=this.ticksY;l++){var c=e-(r+a*l);this.drawLine(this.ctxGridCanvas,o,c,s,c)}}},{key:"drawLine",value:function(t,e,n,i,a){t.beginPath(),this.moveTo(t,e,n),this.lineTo(t,i,a),t.stroke()}},{key:"setStyle",value:function(t,e){Object.keys(e).forEach((function(n){"lineDash"===n?t.setLineDash(e[n]):t[n]=e[n]}))}},{key:"moveTo",value:function(t,e,n){e%1==0&&(e+=.5),n%1==0&&(n+=.5),t.moveTo(e,n)}},{key:"lineTo",value:function(t,e,n){e%1==0&&(e+=.5),n%1==0&&(n+=.5),t.lineTo(e,n)}},{key:"drawToCanvas",value:function(t,e){return t.drawImage(this.elementGridCanvas,0,e),t}}]),t}(),u=n("eNwd"),h=n("l5mm"),d=n("LRne"),p=n("lJxs"),g=n("7o/Q"),f=function(){function t(e,n){_classCallCheck(this,t),this.predicate=e,this.inclusive=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new m(t,this.predicate,this.inclusive))}}]),t}(),m=function(t){function e(t,n,i){var a;return _classCallCheck(this,e),(a=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).predicate=n,a.inclusive=i,a.index=0,a}return _inherits(e,t),_createClass(e,[{key:"_next",value:function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(i){return void n.error(i)}this.nextOrComplete(t,e)}},{key:"nextOrComplete",value:function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())}}]),e}(g.a),v=n("GyhO"),y=function(){function t(e,n,i){_classCallCheck(this,t),this.options=e,this.coordinateManager=n,this.elementContainer=i,this.elementsAxisX=[],this.elementsAxisY=[],this.ticksX=this.options.ticks.x-1,this.ticksY=this.options.ticks.y-1,this.makeAxisCanvas(),this.drawAxisLine(),this.drawAxisValue(),this.updateAxisValue()}return _createClass(t,[{key:"makeAxisCanvas",value:function(){this.elementAxisCanvas=document.createElement("canvas"),this.elementAxisCanvas.setAttribute("width",this.coordinateManager.getWidth()+"px"),this.elementAxisCanvas.setAttribute("height",this.coordinateManager.getHeight()+"px"),this.elementAxisCanvas.setAttribute("style","top: 0px; z-index: 10; position: absolute"),this.elementContainer.appendChild(this.elementAxisCanvas),this.ctxAxisCanvas=this.elementAxisCanvas.getContext("2d")}},{key:"drawAxisLine",value:function(){var t=this.coordinateManager.getWidth(),e=this.coordinateManager.getHeight(),n=this.coordinateManager.getPadding(),i=this.coordinateManager.getBubbleHalfSize(),a=this.options.lineColor,o=this.options.gridAxisStyle,s=this.coordinateManager.getWidthOfChartSpace()/this.ticksX,r=this.coordinateManager.getHeightOfChartSpace()/this.ticksY,l=this.options.tickLength.x,c=this.options.tickLength.y;this.ctxAxisCanvas.lineWidth=o.lineWidth,this.ctxAxisCanvas.globalAlpha=1,this.ctxAxisCanvas.lineCap="round",this.ctxAxisCanvas.strokeStyle=a,this.ctxAxisCanvas.beginPath(),this.moveTo(this.ctxAxisCanvas,n.left,n.top),this.lineTo(this.ctxAxisCanvas,n.left,e-n.bottom),this.lineTo(this.ctxAxisCanvas,t-n.right,e-n.bottom),this.ctxAxisCanvas.stroke();for(var u=0;u<=this.ticksX;u++){var h=n.left+i+s*u;this.ctxAxisCanvas.beginPath(),this.moveTo(this.ctxAxisCanvas,h,e-n.bottom),this.lineTo(this.ctxAxisCanvas,h,e-n.bottom+l),this.ctxAxisCanvas.stroke()}for(var d=0;d<=this.ticksY;d++){var p=e-(n.bottom+i+r*d);this.ctxAxisCanvas.beginPath(),this.moveTo(this.ctxAxisCanvas,n.left,p),this.lineTo(this.ctxAxisCanvas,n.left-c,p),this.ctxAxisCanvas.stroke()}}},{key:"moveTo",value:function(t,e,n){e%1==0&&(e+=.5),n%1==0&&(n+=.5),t.moveTo(e,n)}},{key:"lineTo",value:function(t,e,n){e%1==0&&(e+=.5),n%1==0&&(n+=.5),t.lineTo(e,n)}},{key:"drawAxisValue",value:function(){var t=this.coordinateManager.getWidthOfChartSpace()/this.ticksX,e=this.coordinateManager.getHeightOfChartSpace()/this.ticksY,n=this.coordinateManager.getWidth(),i=this.coordinateManager.getHeight(),a=this.coordinateManager.getPadding(),o=this.coordinateManager.getBubbleHalfSize(),s=this.options.axisColor;this.elementAxisContainer=document.createElement("div");var r="top: 0px; width:".concat(n,"px ; height:").concat(i,"px ;cursor: corsshair; z-index: 10; position: absolute; background-color: rgba(0,0,0,0)");this.elementAxisContainer.setAttribute("style",r),this.elementContainer.appendChild(this.elementAxisContainer);for(var l=0;l<=this.ticksX;l++){var c=document.createElement("div"),u="\n                top: ".concat(i-a.bottom+10,"px;\n                left: ").concat(a.left-t/2+l*t,"px;\n                width: ").concat(t,"px;\n                color: ").concat(s,";\n                position: absolute;\n                text-align: center;\n            ");c.setAttribute("style",u+this.options.axisLabelStyle),c.textContent=" ",this.elementsAxisX.push(c),this.elementAxisContainer.appendChild(c)}for(var h=0;h<=this.ticksY;h++){var d=document.createElement("div"),p="\n                top: ".concat(o+h*e+a.top-10,"px;\n                left: 0px;\n                width: ").concat(a.left-10,"px;\n                color: ").concat(s,";\n                position: absolute;\n                text-align: center;\n                vertical-align: middle;\n            ");d.setAttribute("style",p+this.options.axisLabelStyle),d.textContent=" ",this.elementsAxisY.push(d),this.elementAxisContainer.appendChild(d)}var g=this.options.axisUnit.x;if(""!==g){this.elementAxisXUnit=document.createElement("div");var f="\n                top: ".concat(i-a.bottom+10,"px;\n                right: 80px;\n                color: ").concat(s,";\n                position: absolute;\n                text-align: right;\n            ");this.elementAxisXUnit.setAttribute("style",f+this.options.axisLabelStyle),this.elementAxisXUnit.textContent=g,this.elementAxisContainer.appendChild(this.elementAxisXUnit)}var m=this.options.axisUnit.y;if(""!==m){this.elementAxisYUnit=document.createElement("div");var v="\n                top: 0px;\n                left: 10px;\n                color: ".concat(s,";\n                width: ").concat(a.left-15,";\n                position: absolute;\n                text-align: right;\n                vertical-align: middle;\n            ");this.elementAxisYUnit.setAttribute("style",v+this.options.axisLabelStyle),this.elementAxisYUnit.textContent=m,this.elementAxisContainer.appendChild(this.elementAxisYUnit)}}},{key:"updateAxisValue",value:function(t,e){var n=this,a=this.coordinateManager.getX(),o=this.coordinateManager.getGapX()/this.ticksX;this.elementsAxisX.forEach((function(t,e){var s=i(o*e+a.from).tz(n.options.timezone);t.innerHTML=s.format(n.options.dateFormat[0])+"<br>"+s.format(n.options.dateFormat[1])}));var s=this.coordinateManager.getY(),r=this.coordinateManager.getGapY()/this.ticksY;this.elementsAxisY.forEach((function(t,e){t.innerHTML=(s.to+s.from-(r*e+s.from)).toLocaleString()})),!0===t&&this.animateBackground(this.elementsAxisX[this.elementsAxisX.length-1],e)}},{key:"animateBackground",value:function(t,e){var n=u.a.now();Object(h.a)(1,u.a).pipe(Object(p.a)((function(){return(u.a.now()-n)/e})),function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return n.lift(new f(t,e))}}((function(t){return t<=1})),function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return t.lift.call(Object(v.a).apply(void 0,[t].concat(e)))}}(Object(d.a)(1))).subscribe((function(e){t.style.backgroundColor="rgba(254, 255, 210, ".concat(1-e)}))}},{key:"drawToCanvas",value:function(t,e){var n=0;return t.drawImage(this.elementAxisCanvas,0,e),t.textAlign="center",this.elementsAxisX.forEach((function(i){t.font=i.style.font,t.fillStyle=i.style.color,i.innerHTML.replace(/<br>/gi," ").split(" ").forEach((function(n,a){t.fillText(n,parseInt(i.style.left,10)+i.getBoundingClientRect().width/2,parseInt(i.style.top,10)+15*(a+1)+e)})),n=Math.max(n,parseInt(i.style.left,10))})),t.textAlign="right",this.elementsAxisY.forEach((function(n){t.font=n.style.font,t.fillStyle=n.style.color,t.fillText(n.textContent,n.getBoundingClientRect().width-10,parseInt(n.style.top,10)+15+ +e)})),""!==this.options.axisUnit.x&&this.elementAxisXUnit&&(t.textAlign="right",t.font=this.elementAxisXUnit.style.fontFamily,t.fillStyle=this.elementAxisXUnit.style.color,t.fillText(this.elementAxisXUnit.textContent,n+this.elementAxisXUnit.getBoundingClientRect().width,parseInt(this.elementAxisXUnit.style.top,10)+30+e)),""!==this.options.axisUnit.y&&this.elementAxisYUnit&&(t.textAlign="right",t.font=this.elementAxisYUnit.style.fontFamily,t.fillStyle=this.elementAxisYUnit.style.color,t.fillText(this.elementAxisYUnit.textContent,parseInt(this.elementAxisYUnit.style.left,10)+this.elementAxisYUnit.getBoundingClientRect().width,10+e)),t}},{key:"reset",value:function(){this.updateAxisValue()}}]),t}(),b=n("REft"),x=n("gb1L"),C=function(){function t(e,n,i){_classCallCheck(this,t),this.options=e,this.coordinateManager=n,this.elementContainer=i,this.browserName=Object(x.a)().browser.name,this.outDragArea=new a.b,this.onDragArea$=this.outDragArea.asObservable();var o=this.coordinateManager.getPadding(),s=this.coordinateManager.getWidth()-o.left-o.right,r=this.coordinateManager.getHeight()-o.top-o.bottom;this.initWrapperElement(s,r),this.initXLabelElement(r,10),this.initYLabelElement(o.left,10),this.initDragElement(),this.initEvent()}return _createClass(t,[{key:"initWrapperElement",value:function(t,e){this.elementAxisWrapper=document.createElement("div"),this.elementAxisWrapper.setAttribute("style","\n            top: ".concat(this.coordinateManager.getTopPadding(),"px;\n            left: ").concat(this.coordinateManager.getLeftPadding(),"px;\n            width: ").concat(t,"px;\n            height: ").concat(e,"px;\n            cursor: crosshair;\n            z-index: 600;\n            position: absolute;\n            user-select: none;\n            background-color: rgba(0,0,0,0);\n        ")),this.elementAxisWrapper.setAttribute("class","overlay"),this.elementContainer.appendChild(this.elementAxisWrapper)}},{key:"initXLabelElement",value:function(t,e){this.elementXAxisLabelWrapper=document.createElement("div"),this.elementXAxisLabelWrapper.draggable=!1,this.elementXAxisLabelWrapper.setAttribute("style","\n            top: ".concat(t+e,"px;\n            left: 0px;\n            color: #FFF;\n            width: 80px;\n            display: none;\n            position: absolute;\n            text-align: center;\n            background: #000;\n            user-select: none;\n            font-family: monospace;\n            margin-left: -28px;\n        ")+this.options.axisLabelStyle),this.elementXAxisLabel=document.createElement("span");var n=document.createElement("div");n.setAttribute("style","\n            top: ".concat(-e,"px;\n            left: 27px;\n            height: ").concat(e,"px;\n            position: absolute;\n            border-left: 1px solid red;\n        ")),this.elementXAxisLabelWrapper.appendChild(this.elementXAxisLabel),this.elementXAxisLabelWrapper.appendChild(n),this.elementAxisWrapper.appendChild(this.elementXAxisLabelWrapper)}},{key:"initYLabelElement",value:function(t,e){this.elementYAxisLabelWrapper=document.createElement("div"),this.elementYAxisLabelWrapper.draggable=!1,this.elementYAxisLabelWrapper.setAttribute("style","\n            top: 0px;\n            left: ".concat(-(t-2),"px;\n            color: #fff;\n            width: ").concat(t-2-e,"px;\n            display: none;\n            position: absolute;\n            margin-top: ").concat(-e,"px;\n            text-align: right;\n            background: #000;\n            font-family: monospace;\n            padding-right: 3px;\n            vertical-align: middle;\n        ")+this.options.axisLabelStyle),this.elementYAxisLabel=document.createElement("span");var n=document.createElement("div");n.setAttribute("style","\n            top: 9px;\n            right: -10px;\n            width: ".concat(e,"px;\n            position: absolute;\n            border-top: 1px solid red;\n        ")),this.elementYAxisLabelWrapper.appendChild(this.elementYAxisLabel),this.elementYAxisLabelWrapper.appendChild(n),this.elementAxisWrapper.appendChild(this.elementYAxisLabelWrapper)}},{key:"initDragElement",value:function(){this.elementDragWrapper=document.createElement("div"),this.elementDragWrapper.setAttribute("style","\n            touch-action: none;\n            top: 0px;\n            left: 0px;\n            width: ".concat(this.coordinateManager.getWidth(),"px;\n            height: ").concat(this.coordinateManager.getHeight(),"px;\n            cursor: crosshair;\n            z-index: 601;\n            position: absolute;\n            background-color: rgba(0,0,0,0);\n        ")),this.elementDragArea=document.createElement("div"),this.elementDragArea.setAttribute("style","\n            width: 0px;\n            height: 0px;\n            display: none;\n            position: absolute;\n            border: 1px solid #469AE4;\n            background-color: rgba(237, 242, 248, 0.5);\n        "),this.elementDragWrapper.appendChild(this.elementDragArea),this.elementContainer.appendChild(this.elementDragWrapper)}},{key:"initEvent",value:function(){var t=this,e=this.coordinateManager.getPadding(),n=this.coordinateManager.getWidth(),i=this.coordinateManager.getHeight(),a={leftRevision:this.coordinateManager.getBubbleHalfSize()+e.left,width:n-this.coordinateManager.getBubbleHalfSize()+e.left-e.right,topRevision:e.top,height:i-e.top-e.bottom-this.coordinateManager.getBubbleHalfSize()},o=!1,s=0,r=0,l=0,c=0,u=-1,h=-1,d=0,p=0;function g(t){if(o=!1,this.elementDragArea.style.display="none",t){var e=(l>=s?s:l)-a.leftRevision,n=(l>=s?l:s)-a.leftRevision,i=(c>=r?c:r)-a.topRevision,d=(c>=r?r:c)-a.topRevision;this.outDragArea.next({x:{from:Math.max(e,0),to:Math.min(n,a.width)},y:{from:Math.max(a.height-i,0),to:Math.min(a.height-d,a.height)}})}this.elementDragArea.style.top="0px",this.elementDragArea.style.left="0px",this.elementDragArea.style.width="0px",this.elementDragArea.style.height="0px",u=-1,h=-1}function f(t){t.preventDefault()}["mousedown","touchstart"].forEach((function(e){t.elementDragWrapper.addEventListener(e,(function(e){var n,i,a=e.type.startsWith("touch");if(a){document.body.addEventListener("touchmove",f,{passive:!1});var u=e,h=u.target.offsetParent.getBoundingClientRect();d=u.touches[0].clientX,p=u.touches[0].clientY,n=d-h.left,i=p-h.top}else if("safari"===t.browserName){var g=e.target.offsetParent.getBoundingClientRect();n=d-g.left,i=p-g.top}else{var m=e;n=m.offsetX,i=m.offsetY}o=!0,s=l=n,r=c=i,t.elementDragArea.style.display="block",t.elementDragArea.style.top=r+"px",t.elementDragArea.style.left=s+"px",!1===a&&e.preventDefault()}))})),["mouseup","touchend"].forEach((function(e){t.elementDragWrapper.addEventListener(e,(function(e){var n=e.type.startsWith("touch");g.call(t,!0),!1===n?e.preventDefault():document.body.removeEventListener("touchmove",f)}))})),["mousemove","touchmove"].forEach((function(e){t.elementDragWrapper.addEventListener(e,(function(e){var g,f,m=e.type.startsWith("touch");if(m){var v=e;g=v.touches[0].clientX-d,f=v.touches[0].clientY-p,d=v.touches[0].clientX,p=v.touches[0].clientY}else if("safari"===t.browserName){var y=e;g=y.clientX-d,f=y.clientY-p,d=y.clientX,p=y.clientY}else{var b=e;g=b.movementX,f=b.movementY}l+=g,c+=f,o?(t.checkAxisLabel(l,c,a),u!==l&&l<=n&&(l>=s?(t.elementDragArea.style.left=s+"px",t.elementDragArea.style.width=l-s+"px"):(t.elementDragArea.style.left=l+"px",t.elementDragArea.style.width=s-l+"px"),u=l),h!==c&&c<=i&&(c>=r?(t.elementDragArea.style.top=r+"px",t.elementDragArea.style.height=c-r+"px"):(t.elementDragArea.style.top=c+"px",t.elementDragArea.style.height=r-c+"px"),h=c)):t.checkAxisLabel(g,f,a),!1===m&&e.preventDefault()}))})),this.elementDragWrapper.addEventListener("mouseleave",(function(e){return g.call(t,!1),t.hideAxisLabel(),e.preventDefault(),!1}))}},{key:"checkAxisLabel",value:function(t,e,n){if(this.options.showMouseGuideLine){var i=t-n.leftRevision,a=e-n.topRevision;i>=0&&i<=n.width||a>=0&&a<=n.height?(i>=0&&i<=n.width?this.showXAxisLabel():this.hideXAxisLabel(),a>=0&&a<=n.height?this.showYAxisLabel():this.hideYAxisLabel(),this.setAndMoveAxisLabel(i,a)):this.hideAxisLabel()}}},{key:"setAndMoveAxisLabel",value:function(t,e){var n=this.coordinateManager.getHeight(),a=this.coordinateManager.getPadding(),o=this.coordinateManager.getBubbleHalfSize(),s=i(this.coordinateManager.parseMouseXToXData(t-o)).tz(this.options.timezone).format(this.options.dateFormat[1]),r=this.coordinateManager.parseMouseYToYData(n-e-a.bottom-a.top-o);this.elementXAxisLabel.textContent=s,this.elementYAxisLabel.textContent=r.toLocaleString(),this.elementXAxisLabelWrapper.style.left=t+o+"px",this.elementYAxisLabelWrapper.style.top=e+o+"px"}},{key:"showXAxisLabel",value:function(){this.elementXAxisLabelWrapper.style.display="block"}},{key:"showYAxisLabel",value:function(){this.elementYAxisLabelWrapper.style.display="block"}},{key:"showAxisLabel",value:function(){this.showXAxisLabel(),this.showYAxisLabel()}},{key:"hideXAxisLabel",value:function(){this.elementXAxisLabelWrapper.style.display="none"}},{key:"hideYAxisLabel",value:function(){this.elementYAxisLabelWrapper.style.display="none"}},{key:"hideAxisLabel",value:function(){this.hideXAxisLabel(),this.hideYAxisLabel()}}]),t}();n.d(e,"a",(function(){return k}));var k=function(){function t(e,n,i,s,r,l,c,u,h,d,p,g){_classCallCheck(this,t),this.mode=e,this.element=n,this.fromX=i,this.toX=s,this.fromY=r,this.toY=l,this.application=c,this.width=h,this.height=d,this.timezone=p,this.dateFormat=g,this.dataBlocks=[],this.agentList=[],this.selectedAgent="",this.outSelect=new a.b,this.outError=new a.b,this.outChangeRangeX=new a.b,this.downloadElement=document.createElement("a"),this.selectedAgent=u,this.setOptions(),this.initManagers(),this.onSelect$=this.outSelect.asObservable(),this.onError$=this.outError.asObservable(),this.onChangeRangeX$=this.outChangeRangeX.asObservable(),this.outTransactionCount=new o.a(this.getTransactionCount(!0)),this.onChangeTransactionCount$=this.outTransactionCount.asObservable()}return _createClass(t,[{key:"isAllowedAgent",value:function(t,e){return""===t||t===e}},{key:"getTransactionCount",value:function(t){var e=this,n={},i=this.coordinateManager.getX();return this.typeManager.getTypeNameList().forEach((function(t){n[t]={count:0,checked:e.typeManager.isCheckedByName(t)}})),!1===t&&this.typeManager.getTypeNameList().forEach((function(t){n[t].count=0,e.dataBlocks.forEach((function(a){a.getXRange().to>=i.from&&a.getAgentList().forEach((function(o){e.isAllowedAgent(e.selectedAgent,o)&&(n[t].count+=a.getCount(o,t,i.from,i.to))}))}))})),n}},{key:"setOptions",value:function(){this.options={mode:this.mode,prefix:"scatter-chart-"+1e4*Math.random(),width:this.width,height:this.height,bubbleRadius:3,padding:{top:20,left:60,right:40,bottom:40},axisLabelStyle:"font-size:10px; line-height: 12px; padding-top: 3px",axisColor:"#000",lineColor:"#3D3D3D",x:{from:this.fromX,to:this.toX},y:{from:this.fromY,to:this.toY},z:{from:0,to:5},ticks:{x:5,y:5},tickLength:{x:10,y:10},gridAxisStyle:{lineDash:[1,0],lineWidth:1,globalAlpha:1,strokeStyle:"#e3e3e3"},axisUnit:{x:"",y:"(ms)"},showMouseGuideLine:!0,animationDuration:300,timezone:this.timezone,dateFormat:this.dateFormat}}},{key:"initManagers",value:function(){var t=this;this.typeManager=new b.a(b.a.getDefaultTransactionTypeInfo()),this.coordinateManager=new s(this.options),this.gridRenderer=new c(this.options,this.coordinateManager,this.element),this.axisRenderer=new y(this.options,this.coordinateManager,this.element),this.rendererManager=new l(this.options,this.coordinateManager,this.element,this.typeManager),this.mouseManager=new C(this.options,this.coordinateManager,this.element),this.mouseManager.onDragArea$.subscribe((function(e){var n=t.coordinateManager.parseMouseXToXData(e.x.from),i=t.coordinateManager.parseMouseXToXData(e.x.to),a=t.coordinateManager.parseMouseYToYData(e.y.from),o=t.coordinateManager.parseMouseYToYData(e.y.to);t.hasDataByXY(n,i,a,o)&&t.outSelect.next({x:{from:n,to:i},y:{from:a,to:o},drag:e,type:t.typeManager.getCheckedTypeNameList(),agent:t.selectedAgent})}))}},{key:"changeShowType",value:function(t){this.typeManager.setChecked(t.name,t.checked),this.rendererManager.setTypeView(this.selectedAgent,t.name,t.checked)}},{key:"redrawDataBlock",value:function(){var t=this;this.dataBlocks.forEach((function(e){t.drawDataBlock(e)}))}},{key:"reset",value:function(t,e,n,i,a,o){this.fromX=n,this.toX=i,this.options.mode=this.mode=a,this.coordinateManager.resetInitX(n),this.coordinateManager.setX(n,i),this.typeManager.reset(),this.application=t,this.selectedAgent=e,this.dataBlocks=[],this.agentList=[],this.axisRenderer.reset(),this.rendererManager.reset(),o&&this.changeShowType(o),this.outTransactionCount.next(this.getTransactionCount(!0))}},{key:"addAgent",value:function(t){var e=this;t.forEach((function(t){-1===e.agentList.lastIndexOf(t)&&e.agentList.push(t)})),this.agentList.sort()}},{key:"addData",value:function(e,n){var i=this.coordinateManager.getX(),a=e.getXRange();this.options.mode===t.MODE.STATIC&&a.from>=i.to||(this.addAgent(e.getAgentList()),this.dataBlocks.push(e),this.drawDataBlock(e),this.options.mode!==t.MODE.STATIC&&(this.moveChart(e,n||300),this.removeBubble()),this.changeSelectedAgent(this.selectedAgent))}},{key:"drawDataBlock",value:function(t){var e=this,n=this.options.prefix;this.rendererManager.makeDataCanvas(t,t.getAgentList()),this.agentList.forEach((function(i){for(var a=0,o=t.countByAgent(i);a<o;a++){var s=t.getDataByAgentAndIndex(i,a);if(0!==t.getGroupCount(s)){var r=t.getTypeIndex(s),l=e.typeManager.getNameByIndex(r),c=e.typeManager.getColorByIndex(r);e.rendererManager.drawTransaction("".concat(i,"-").concat(n,"-").concat(l),c,s)}}}))}},{key:"moveChart",value:function(t,e){var n=this.coordinateManager.getX(),i=t.getXRange(),a=this.options.animationDuration;if(i.from>=n.to){var o=i.to-n.to,s=o*this.coordinateManager.getPixelPerTime();this.coordinateManager.setX(n.from+o,n.to+o),this.axisRenderer.updateAxisValue(!0,2*a),this.rendererManager.moveChart(Math.floor(s),e<a?0:a),this.outChangeRangeX.next({from:n.from+o,to:n.to+o})}}},{key:"removeBubble",value:function(){for(var t=this.coordinateManager.getX().from,e=0;e<this.dataBlocks.length&&this.dataBlocks[e].getXRange().to<t;e++)this.dataBlocks.shift(),e--}},{key:"getDataByRange",value:function(t,e,n,i,a,o){t=+t,e=+e,n=+n,i=+i;var s=[],r=this.coordinateManager.getY(),l={};o.forEach((function(t){l[t]=!0}));for(var c=0;c<this.dataBlocks.length;c++)for(var u=this.dataBlocks[c],h=0,d=u.getTotalCount();h<d;h++){var p=u.getXRange();if(!(p.to<t||p.from>e)){var g=u.getDataByIndex(h),f=u.getAgentName(g);if(this.isAllowedAgent(a,f)){var m=u.getX(g),v=u.getY(g);this.isInRange(t,e,m)&&(this.isInRange(n,i,v)||v>i&&i>=r.to||v<n&&n<=r.from)&&!0===l[this.typeManager.getNameByIndex(u.getTypeIndex(g))]&&s.push([u.getTransactionID(g),m,v])}}}return s}},{key:"hasDataByXY",value:function(t,e,n,i){t=+t,e=+e,n=+n,i=+i;for(var a=this.coordinateManager.getY(),o=0;o<this.dataBlocks.length;o++)for(var s=this.dataBlocks[o],r=0,l=s.getTotalCount();r<l;r++){var c=s.getDataByIndex(r),u=s.getAgentName(c);if(this.isAllowedAgent(this.selectedAgent,u)){var h=s.getX(c),d=s.getY(c);if(this.isInRange(t,e,h)&&(this.isInRange(n,i,d)||d>i&&i>=a.to||d<n&&n<=a.from)&&this.typeManager.isCheckedByIndex(s.getTypeIndex(c)))return!0}}return!1}},{key:"isInRange",value:function(t,e,n){return n>=t&&n<=e}},{key:"downloadChartAsImage",value:function(t){var e=this,n=this.coordinateManager.getX(),a=this.coordinateManager.getWidth(),o=this.coordinateManager.getHeight()+60+40,s=document.createElement("canvas");s.setAttribute("width",a+"px"),s.setAttribute("height",o+"px");var r=s.getContext("2d");r.fillStyle="#FFFFFF",r.fillRect(0,0,a,o),this.gridRenderer.drawToCanvas(r,60),this.axisRenderer.drawToCanvas(r,60),this.rendererManager.drawToCanvas(r,60),r.textAlign="left",r.font="24px monospace",r.fillText(this.application,10,10),r.font="14px monospace",r.fillText(i(n.from).tz(this.timezone).format(this.dateFormat[0]+" "+this.dateFormat[1])+" ~ "+i(n.to).tz(this.timezone).format(this.dateFormat[0]+" "+this.dateFormat[1]),10,40),this.typeManager.getTypeNameList().forEach((function(t,n){var i=e.typeManager.getColorByName(t),a=e.typeManager.isCheckedByName(t),s=0;e.dataBlocks.forEach((function(n){s+=n.getCount(e.selectedAgent,t)})),r.textAlign="left",r.font="16px monospace",a?(r.fillStyle=i,r.fillRect(200*n+10,o-40+10,20,20)):(r.lineWidth=4,r.strokeStyle=i,r.strokeRect(200*n+10,o-40+10,20,20)),r.fillStyle="#000",r.fillText("".concat(t," : ").concat(s),200*n+40,o-40+10)})),this.downloadElement.setAttribute("href",s.toDataURL("image/"+t)),this.downloadElement.setAttribute("download","Pinpoint_Scatter_Chart[".concat(i(n.from).tz(this.timezone).format(this.dateFormat[0]+"_"+this.dateFormat[1]),"~").concat(i(n.to).tz(this.timezone).format(this.dateFormat[0]+"_"+this.dateFormat[1]),"].png")),this.downloadElement.dispatchEvent(new MouseEvent("click"))}},{key:"redraw",value:function(){this.rendererManager.clear(),this.axisRenderer.updateAxisValue(),this.redrawDataBlock()}},{key:"changeYRange",value:function(t){this.fromY=+t.from,this.toY=+t.to,this.coordinateManager.setY(+t.from,+t.to),this.redraw()}},{key:"changeSelectedAgent",value:function(t){this.selectedAgent=t,this.rendererManager.showSelectedAgent(t),this.outTransactionCount.next(this.getTransactionCount(!1))}},{key:"getCurrentAgent",value:function(){return this.selectedAgent}},{key:"isEmpty",value:function(){if(this.options.mode===t.MODE.STATIC){var e=!0;return this.dataBlocks.forEach((function(t){e=e&&t.isEmpty()})),e}return!1}},{key:"getTypeManager",value:function(){return this.typeManager}},{key:"setTimezone",value:function(t){this.options.timezone=this.timezone=t}},{key:"setDateFormat",value:function(t){this.options.dateFormat=this.dateFormat=t}}]),t}();k.MODE={REALTIME:"realtime",STATIC:"static"}},zw4y:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("2Vo4"),a=n("XNiG"),o=function(){function t(){_classCallCheck(this,t),this.outChartData=new i.a({instanceKey:"",data:null}),this.outViewType=new a.b,this.outChangeYRange=new a.b,this.outSelectedAgent=new a.b,this.outInvokeDownloadChart=new a.b,this.outReset=new a.b,this.outError=new a.b,this.onChartData$=this.outChartData.asObservable(),this.onViewType$=this.outViewType.asObservable(),this.onChangeYRange$=this.outChangeYRange.asObservable(),this.onSelectedAgent$=this.outSelectedAgent.asObservable(),this.onInvokeDownloadChart$=this.outInvokeDownloadChart.asObservable(),this.onReset$=this.outReset.asObservable(),this.onError$=this.outError.asObservable()}return _createClass(t,[{key:"addChartData",value:function(t,e){this.outChartData.next({instanceKey:t,data:e})}},{key:"changeViewType",value:function(t){this.outViewType.next(t)}},{key:"changeYRange",value:function(t){this.outChangeYRange.next(t)}},{key:"changeAgent",value:function(t,e){this.outSelectedAgent.next({instanceKey:t,agent:e})}},{key:"downloadChart",value:function(t){this.outInvokeDownloadChart.next(t)}},{key:"reset",value:function(t,e,n,i,a,o){this.outReset.next({instanceKey:t,application:e,agent:n,from:i,to:a,mode:o})}},{key:"setError",value:function(t){this.outError.next(t)}}]),t}()}}]);